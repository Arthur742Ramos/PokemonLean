[[tasks]]
prompt = """Create PokemonLean/PokemonLean/SharePerturbation.lean with formal share perturbation theorems.

Read PokemonLean/PokemonLean/RealMetagame.lean to understand how meta shares and matchup rates are encoded. The key idea: expected WR vs field depends on what opponents play. If meta shares shift, expected WRs change.

The expected WR of deck i vs the field is:
  E[WR_i] = Σ_j (share_j / (1 - share_i)) * matchup(i,j)
where share_j is opponent j's share, normalized to exclude deck i itself.

CURRENT SHARES (from RealMetagame.lean):
Dragapult 155/1000, Gholdengo 99/1000, Grimmsnarl 51/1000, MegaAbsol 50/1000, Gardevoir 46/1000, CharizardNoc 43/1000, GardJell 42/1000, CharPid 35/1000, DragChar 35/1000, RagBolt 33/1000, NsZoro 30/1000, Alakazam 28/1000, Kangaskhan 25/1000, Ceruledge 23/1000

KEY MATCHUP RATES (from RealMetagame.lean — read the file to get exact rationals):
- Dragapult vs Grimmsnarl: 386/1000 (38.6%)
- Grimmsnarl vs Dragapult: 572/1000 (57.2%)
- etc. (use the full 14x14 matrix from the file)

THEOREMS TO PROVE:

1. paradox_holds_drag_at_10pct:
   If Dragapult share drops to 100/1000 (10%) and the freed 5.5% is distributed proportionally among other decks, recompute expected WRs. Prove Dragapult expected WR is still < 50%.

2. paradox_holds_drag_at_5pct:
   If Dragapult share drops to 50/1000 (5%), redistributed proportionally, Dragapult expected WR still < 50%.

3. grimmsnarl_stays_best_at_10pct:
   If Grimmsnarl rises to 100/1000 (10%) with share taken proportionally from others, Grimmsnarl expected WR is still > 50% and still highest among top decks.

4. grimmsnarl_stays_best_at_15pct:
   If Grimmsnarl becomes the most popular at 155/1000 (15.5%, swapping with Dragapult's current share), does it still have > 50% expected WR?

5. paradox_independent_of_popularity:
   The key insight: Dragapult's BAD matchup spread (loses to 9/13) means it underperforms regardless of its own popularity. Prove that for ANY Dragapult share from 1% to 30%, its expected WR vs the rest of the field (with other shares proportionally adjusted) remains below 50%.
   This might be hard to prove for arbitrary values — if so, prove it for specific sample points: 5%, 10%, 15%, 20%, 25%.

6. share_sensitivity_bound:
   Compute how much the top-6 share distribution would need to change (in L1 distance) before the tier ordering (S/A/B/C) changes. Even a rough bound is valuable.

Use exact rational arithmetic. Prove with native_decide, norm_num, omega, simp. ZERO sorry.
If a theorem is too hard to prove, DELETE it rather than using sorry.

Add import to PokemonLean.lean if needed.

Commit: feat: SharePerturbation.lean — formal meta share sensitivity analysis"""
